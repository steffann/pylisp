#!/usr/bin/env python
'''
Created on 11 jan. 2013

@author: sander
'''
from pylisp.packet.lisp.control.map_register import MapRegisterMessage

mr_hex = '32000103231160949b9d0f19000100144f7d688298392e6baed4ac0dd38419aedb715792000005a0031e100000000001254d39383264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031a100000000001254d38403264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031f100000000001254d38203264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b0000000000000000015d611bb0e7a5daa92328a824c059a66a0000000000000000'
mr_hex = '32000102e4436f2d3ff8c89600010014f9cb9f835523cbf71536240a8d0edd989e8a6430000005a003301000000000022a0086400001000000000000000000003264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a003301000000000022a0086401009000000000000000000003264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b0000000000000000015d611bb0e7a5daa92328a824c059a66a0000000000000000'

lispd = '32000103231160949b9d0f19000100144f7d688298392e6baed4ac0dd38419aedb715792000005a0031e100000000001254d39383264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031a100000000001254d38403264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031f100000000001254d38203264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b0000000000000000015d611bb0e7a5daa92328a824c059a66a0000000000000000'
tshrk = '32000503231160949b9d0f19000100144f7d688298392e6baed4ac0dd38419aedb715792000005a0031e100000000001254d39383264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031a100000000001254d38403264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b000000000000000001000005a0031f100000000001254d38203264ff000005000157c3c44d0a64ff00000500015f61535d3264ff0000050002200109e085000b0000000000000000015d611bb0e7a5daa92328a824c059a66a0000000000000000'
mr_hex = tshrk

mr_bytes = mr_hex.decode('hex')
mr = MapRegisterMessage.from_bytes(mr_bytes)
assert isinstance(mr, MapRegisterMessage)
print mr_bytes == bytes(mr)
print mr.verify_authentication_data('BlaBla')
print mr.verify_authentication_data('SomeStrangePassword123')
